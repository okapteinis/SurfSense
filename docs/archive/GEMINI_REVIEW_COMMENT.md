@gemini-code-assist Please perform a comprehensive review of this codebase focusing on:

1. **Security vulnerabilities** in authentication and authorization
2. **SQL injection** or **XSS** risks
3. **Performance bottlenecks**
4. **Code quality** and best practices
5. **Missing error handling**
6. **TypeScript and Python type safety**
7. **Dependency security issues**

Please review all files but prioritize:
- `surfsense_backend/app/routes/two_fa_routes.py`
- `surfsense_backend/app/users.py`
- `surfsense_web/lib/apis/auth-api.service.ts`
- `surfsense_web/middleware.ts`
- Database migration files

/gemini review
